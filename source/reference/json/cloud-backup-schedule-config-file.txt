.. _atlas-cli-cloud-backup-schedule-config-file:

========================================
Cloud Backup Schedule Configuration File
========================================

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

You can use a cloud backup schedule configuration file to specify the
settings required when you update a cloud backup schedule using the
{+atlas-cli+}. The {+atlas-cli+} accepts ``.json`` cloud backup schedule
configuration files.

Use the following resources to:

- Learn the :ref:`settings <cloud-backup-schedule-settings>`
  you can specify in the cloud backup schedule configuration file.
- View and copy :ref:`sample configuration files
  <example-cloud-backup-schedule-config-file>`.

.. _cloud-backup-schedule-settings:

Cloud Backup Schedule Settings
------------------------------

|service| allows you to specify the following settings to update a cloud
backup schedule with the {+atlas-cli+}. You can specify these cloud backup
schedule settings either in the configuration file or as flags in the
command:

.. list-table:: 
   :header-rows: 1 
   :widths: 20 10 70 

   * - Field 
     - Type 
     - Description 

   * - ``autoExportEnabled``
     - boolean
     - Flag that indicates whether MongoDB Cloud automatically exports
       cloud backup snapshots to the |aws| bucket.

   * - ``copySettings``
     - array
     - List that contains a document for each copy setting item in the
       desired backup policy.

   * - ``copySettings.``
       ``cloudProvider``
     - string
     - Human-readable label that identifies the cloud provider that
       stores the snapshot copy.

   * - ``copySettings.``
       ``frequencies``
     - array of strings
     - List that describes which types of snapshots to copy.

   * - ``copySettings.``
       ``regionName``
     - string
     - Target region to copy snapshots belonging to ``replicationSpecId``
       to. Please supply the 'Atlas Region' which can be found under
       `Cloud Providers <https://www.mongodb.com/docs/atlas/reference/cloud-providers/>`__
       'regions' link. 

   * - ``copySettings``
       ``.replicationSpecId``
     - string
     - Unique 24-hexadecimal digit string that identifies the
       replication object for a zone in a cluster. For global clusters,
       there can be multiple zones to choose from. For sharded clusters
       and replica set clusters, there is only one zone in the cluster.
       To find the Replication Spec Id, do a GET request to Return One
       Cluster in One Project and consult the replicationSpecs array
       :oas-atlas-op:`Return One Cluster in One Project
       </getLegacyCluster>`.

   * - ``copySettings.``
       ``shouldCopyOplogs``
     - boolean
     - Flag that indicates whether to copy the oplogs to the target
       region. You can use the oplogs to perform point-in-time restores.

   * - ``deleteCopiedBackups``
     - array
     - List that contains a document for each copy setting item in the
       desired backup policy.

   * - ``deleteCopiedBackups.``
       ``cloudProvider``
     - string
     - Human-readable label that identifies the cloud provider for the
       deleted copy setting whose backup copies you want to delete.

   * - ``deleteCopiedBackups.``
       ``regionName``
     - string
     - Target region for the deleted copy setting whose backup copies
       you want to delete. Please supply the 'Atlas Region' which can be
       found under `Cloud Providers
       <https://www.mongodb.com/docs/atlas/reference/cloud-providers/>`__
       'regions' link.

   * - ``deleteCopiedBackups``
       ``.replicationSpecId``
     - string
     - Unique 24-hexadecimal digit string that identifies the
       replication object for a zone in a cluster. For global clusters,
       there can be multiple zones to choose from. For sharded clusters
       and replica setclusters, there is only one zone in the cluster.
       To find the Replication Spec Id, do a GET request to Return One
       Cluster in One Project and consult the replicationSpecs array
       :oas-atlas-op:`Return One Cluster in One Project
       </getLegacyCluster>`.

   * - ``export``
     - object
     - List that contains a document for each copy setting item in the
       desired backup policy.

   * - ``export.``
       ``exportBucketId``
     - string
     - Unique 24-hexadecimal character string that identifies the |aws|
       Bucket.

   * - ``export.``
       ``frequencyType``
     - string
     - Human-readable label that indicates the rate at which the export
       policy item occurs.

   * - ``policies``
     - array
     - Rules set for this backup schedule.

   * - ``policies.``
       ``id``
     - string
     - Unique 24-hexadecimal digit string that identifies this backup
       policy.

   * - ``policies.``
       ``policyItems``
     - array
     - List that contains the specifications for one policy.

   * - ``policies.``
       ``policyItems.``
       ``frequencyInterval``
     - integer
     - Number that indicates the frequency interval for a set of
       snapshots. A value of ``1`` specifies the first instance of the
       corresponding ``frequencyType``.

       - In a monthly policy item, ``1`` indicates that the monthly
         snapshot occurs on the first day of the month and ``40``
         indicates the last day of the month.

       - In a weekly policy item, ``1`` indicates that the weekly
         snapshot occurs on Monday and ``7`` indicates Sunday.

       - In an hourly policy item, you can set the frequency interval to
         ``1``, ``2``, ``4``, ``6``, ``8``, or ``12``. For hourly policy
         items for NVMe clusters, MongoDB Cloud only accepts ``12`` as
         the frequency interval value.

   * - ``policies.``
       ``policyItems.``
       ``frequencyType``
     - string
     - Human-readable label that identifies the frequency type
       associated with the backup policy.

   * - ``policies.``
       ``policyItems.``
       ``retentionUnit``
     - string
     - Unit of time in which MongoDB Cloud measures snapshot retention.

   * - ``policies.``
       ``policyItems.``
       ``retentionValue``
     - integer
     - Duration in days, weeks, or months that MongoDB Cloud retains the
       snapshot. For less frequent policy items, MongoDB Cloud requires
       that you specify a value greater than or equal to the value
       specified for more frequent policy items. 

       For example: If the hourly policy item specifies a retention of two
       days, you must specify two days or greater for the retention of the
       weekly policy item. 

   * - ``referenceHourOfDay``
     - integer
     - Hour of day in Coordinated Universal Time (UTC) that represents
       when MongoDB Cloud takes the snapshot.

   * - ``referenceMinuteOfHour``
     - integer
     - Minute of the ``referenceHourOfDay`` that represents when MongoDB
       Cloud takes the snapshot.

   * - ``restoreWindowDays``
     - integer
     - Number of previous days that you can restore back to with
       Continuous Cloud Backup accuracy. You must specify a positive,
       non-zero integer. This parameter applies to continuous cloud
       backups only.

   * - ``updateSnapshots``
     - boolean
     - Flag that indicates whether to apply the retention changes in the
       updated backup policy to snapshots that MongoDB Cloud took
       previously.

   * - ``useOrgAndGroupNamesInExportPrefix``
     - boolean
     - Flag that indicates whether to use organization and project names
       instead of organization and project UUIDs in the path to the
       metadata files that MongoDB Cloud uploads to your |aws| bucket. 

For a full list of available settings, see the API documentation for
:oas-atlas-op:`Update Cloud Backup Schedule for One Cluster </cloudProvider>`.

.. _example-cloud-backup-schedule-config-file:

Example Cloud Backup Schedule Configuration File
------------------------------------------------

To update a cloud backup schedule for a single cluster, specify the same
service provider for your ``regionConfigs`` objects as shown in the
following example file:

.. literalinclude:: /includes/update-cloud-backup-schedule-config-file.json
